---
services:
  aws.greengrass.Nucleus:
    configuration:
      runWithDefault:
        posixUser: nobody
        windowsUser: integ-tester
      logging:
        level: "DEBUG"
  aws.greengrass.clientdevices.Auth:
    configuration:
      enableSingleCharacterWildcardMatching: true
      deviceGroups:
        formatVersion: "2021-03-05"
        definitions:
          myThing:
            selectionRule: "thingName: myThing"
            policyName: "thingAccessPolicy"
        policies:
          thingAccessPolicy:
            subscribe:
              statementDescription: "mqtt subscribe"
              operations:
                - "mqtt:subscribe"
              resources:
                - "mqtt:topic:${iot:Connection.Thing.ThingName}/???/test/*"
  main:
    dependencies:
      - aws.greengrass.clientdevices.Auth
